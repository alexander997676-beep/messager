<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GhostMsg Elite</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* --- THEME CONFIGURATION --- */
        :root {
            --bg-deep: #000000;
            --surface: #121212;
            --surface-light: #1e1e1e;
            
            /* Default Theme: Neon (Violet) */
            --accent: #8b5cf6;
            --accent-grad: linear-gradient(135deg, #8b5cf6, #ec4899);
            --accent-glow: rgba(139, 92, 246, 0.5);
            
            --text-main: #ffffff;
            --text-sub: #9ca3af;
            
            --radius-xl: 32px;
            --radius-lg: 20px;
            --radius-md: 12px;
            
            --glass: rgba(20, 20, 20, 0.6);
            --glass-border: rgba(255, 255, 255, 0.08);
            --font-main: 'Outfit', sans-serif;
        }

        /* Theme Variants */
        [data-theme="sunset"] { --accent: #f97316; --accent-grad: linear-gradient(135deg, #f97316, #eab308); --accent-glow: rgba(249, 115, 22, 0.5); }
        [data-theme="ocean"] { --accent: #06b6d4; --accent-grad: linear-gradient(135deg, #06b6d4, #3b82f6); --accent-glow: rgba(6, 182, 212, 0.5); }
        [data-theme="cyber"] { --accent: #22c55e; --accent-grad: linear-gradient(135deg, #22c55e, #10b981); --accent-glow: rgba(34, 197, 94, 0.5); }

        /* --- GLOBAL RESET --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
        body {
            font-family: var(--font-main);
            background-color: var(--bg-deep);
            color: var(--text-main);
            margin: 0;
            overflow: hidden; /* App feel */
            height: 100vh;
            display: flex;
            justify-content: center;
        }

        /* --- AURORA BACKGROUND --- */
        .aurora-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: #000; overflow: hidden;
        }
        .aurora-blob {
            position: absolute; width: 50vw; height: 50vw; background: var(--accent);
            filter: blur(80px); opacity: 0.3; border-radius: 50%;
            animation: drift 15s infinite alternate ease-in-out;
            transition: background 0.5s ease;
        }
        .blob-1 { top: -10%; left: -10%; animation-delay: 0s; }
        .blob-2 { bottom: -10%; right: -10%; background: #fff; opacity: 0.1; animation-delay: -5s; }
        .blob-3 { top: 40%; left: 40%; width: 30vw; height: 30vw; animation-delay: -10s; }
        @keyframes drift { 0% { transform: translate(0, 0) scale(1); } 100% { transform: translate(20px, 40px) scale(1.1); } }

        /* --- APP SHELL --- */
        .app-container {
            width: 100%; max-width: 480px; height: 100%;
            background: rgba(0,0,0,0.01);
            display: flex; flex-direction: column; position: relative;
        }

        /* --- SCROLL CONTENT --- */
        .scroll-view {
            flex: 1; overflow-y: auto; overflow-x: hidden;
            padding: 24px; padding-bottom: 120px;
            scroll-behavior: smooth;
        }
        .scroll-view::-webkit-scrollbar { display: none; }

        /* --- TYPOGRAPHY --- */
        h1, h2, h3 { margin: 0; font-weight: 700; letter-spacing: -0.5px; }
        .text-gradient { background: var(--accent-grad); -webkit-background-clip: text; color: transparent; }
        .text-muted { color: var(--text-sub); font-size: 14px; }

        /* --- COMPONENTS --- */
        .card {
            background: var(--surface); border: 1px solid var(--glass-border);
            padding: 20px; border-radius: var(--radius-lg); margin-bottom: 16px;
            box-shadow: 0 10px 40px -10px rgba(0,0,0,0.5);
            transition: transform 0.2s; position: relative; overflow: hidden;
        }
        .card:active { transform: scale(0.98); }

        .btn {
            width: 100%; padding: 18px; border: none; border-radius: var(--radius-lg);
            background: var(--text-main); color: #000; font-weight: 700; font-size: 16px;
            cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-primary { background: var(--accent-grad); color: white; box-shadow: 0 8px 20px -5px var(--accent-glow); }
        .btn-ghost { background: rgba(255,255,255,0.05); color: var(--text-main); }
        .btn:active { transform: scale(0.95); }

        .input-field {
            width: 100%; background: var(--surface-light); border: 1px solid transparent;
            padding: 18px; border-radius: var(--radius-lg); color: white; font-size: 16px;
            font-family: inherit; margin-bottom: 15px; transition: 0.3s;
        }
        .input-field:focus { border-color: var(--accent); background: var(--surface); }

        /* --- FLOATING DOCK NAV --- */
        .dock-nav {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: rgba(20, 20, 20, 0.85); backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            padding: 12px 25px; border-radius: 100px;
            display: flex; gap: 30px; align-items: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.6); z-index: 50;
            transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .dock-item {
            font-size: 20px; color: var(--text-sub); transition: 0.3s; position: relative; cursor: pointer;
            width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%;
        }
        .dock-item.active { color: white; background: var(--accent-grad); box-shadow: 0 5px 15px var(--accent-glow); transform: translateY(-10px); }
        
        /* --- VIEWS & TRANSITIONS --- */
        .view-section { display: none; animation: fadeIn 0.4s ease; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- STORY MODE OVERLAY (For Screenshots) --- */
        .story-overlay {
            position: fixed; inset: 0; background: #000; z-index: 100;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: 0.4s; transform: scale(0.95);
        }
        .story-overlay.open { opacity: 1; pointer-events: all; transform: scale(1); }
        
        .story-card {
            width: 85%; aspect-ratio: 9/16; max-height: 70vh;
            background: linear-gradient(180deg, var(--surface) 0%, #000 100%);
            border: 1px solid var(--glass-border); border-radius: var(--radius-xl);
            padding: 40px; display: flex; flex-direction: column; justify-content: center; text-align: center;
            box-shadow: 0 0 100px -20px var(--accent-glow); position: relative;
        }
        .story-badge {
            background: var(--accent-grad); padding: 8px 16px; border-radius: 100px;
            font-size: 12px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px;
            position: absolute; top: 30px; left: 50%; transform: translateX(-50%);
        }

        /* --- THEME SELECTOR --- */
        .theme-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 20px; }
        .theme-dot {
            height: 40px; border-radius: 12px; cursor: pointer; border: 2px solid transparent; opacity: 0.6;
        }
        .theme-dot.active { border-color: white; opacity: 1; transform: scale(1.1); }

        /* --- UTILS --- */
        .logo { font-size: 24px; font-weight: 800; display: flex; align-items: center; gap: 10px; margin-bottom: 30px; }
        .hidden { display: none !important; }
        .toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100%);
            background: white; color: black; padding: 12px 24px; border-radius: 100px; font-weight: 600;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5); z-index: 200; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            opacity: 0;
        }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

    </style>
</head>
<body>

<!-- DYNAMIC BACKGROUND -->
<div class="aurora-bg">
    <div class="aurora-blob blob-1"></div>
    <div class="aurora-blob blob-2"></div>
    <div class="aurora-blob blob-3"></div>
</div>

<div class="app-container">

    <!-- 1. AUTH SCREEN -->
    <div id="view-auth" class="view-section active">
        <div class="scroll-view" style="display:flex; flex-direction:column; justify-content:center; padding-bottom: 24px;">
            <div class="logo"><i class="fas fa-ghost text-gradient"></i> GhostMsg Elite</div>
            
            <h1 style="font-size: 42px; line-height: 1.1; margin-bottom: 10px;">
                Unleash <br> <span class="text-gradient">Honesty.</span>
            </h1>
            <p class="text-muted" style="margin-bottom: 40px;">Receive anonymous messages. Share your link. Create content.</p>

            <div id="auth-forms">
                <!-- LOGIN FORM -->
                <form id="form-login" onsubmit="app.login(event)">
                    <input type="text" id="l-user" class="input-field" placeholder="Username" required autocomplete="off">
                    <input type="password" id="l-pass" class="input-field" placeholder="Password" required>
                    <button type="submit" class="btn btn-primary">Enter Dashboard <i class="fas fa-arrow-right"></i></button>
                    <div style="text-align:center; margin-top:20px;">
                        <span class="text-muted">New here?</span> <a href="#" onclick="app.toggleAuth('signup')" style="color:white; text-decoration:none; font-weight:bold;">Create Account</a>
                    </div>
                </form>

                <!-- SIGNUP FORM (Hidden) -->
                <form id="form-signup" class="hidden" onsubmit="app.register(event)">
                    <input type="text" id="r-user" class="input-field" placeholder="Choose Username" required autocomplete="off">
                    <input type="password" id="r-pass" class="input-field" placeholder="Create Password" required>
                    <button type="submit" class="btn btn-primary">Start Journey</button>
                    <div style="text-align:center; margin-top:20px;">
                        <span class="text-muted">Have an account?</span> <a href="#" onclick="app.toggleAuth('login')" style="color:white; text-decoration:none; font-weight:bold;">Login</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 2. DASHBOARD (Tabs) -->
    
    <!-- INBOX TAB -->
    <div id="view-inbox" class="view-section">
        <div class="scroll-view">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 20px;">
                <h2>Inbox</h2>
                <div class="text-muted"><i class="fas fa-sync-alt" onclick="app.renderInbox()"></i></div>
            </div>
            <div id="msg-container"></div>
        </div>
    </div>

    <!-- PROFILE TAB -->
    <div id="view-profile" class="view-section">
        <div class="scroll-view">
            <div class="card" style="text-align:center; padding: 40px 20px;">
                <div style="width:100px; height:100px; background:var(--surface-light); border-radius:50%; margin:0 auto 20px; display:grid; place-items:center; font-size:40px; color:var(--text-main); border:2px solid var(--accent);">
                    <i class="fas fa-user-astronaut"></i>
                </div>
                <h2 id="p-user">@username</h2>
                <div class="text-muted" style="margin-top:5px;">Elite Member</div>
            </div>

            <div class="card">
                <h3>My Link</h3>
                <p class="text-muted" style="font-size:12px; margin: 10px 0;">Share this on your Instagram Story.</p>
                <div style="background:var(--surface-light); padding:15px; border-radius:12px; font-family:monospace; color:var(--accent); overflow:hidden; white-space:nowrap; text-overflow:ellipsis;" id="p-link">...</div>
                <button class="btn btn-primary" onclick="app.copyLink()" style="margin-top:15px; padding:12px;">Copy Link</button>
            </div>

            <div class="card">
                <h3>App Theme</h3>
                <div class="theme-grid">
                    <div class="theme-dot active" style="background:#8b5cf6;" onclick="app.setTheme('neon', this)"></div>
                    <div class="theme-dot" style="background:#f97316;" onclick="app.setTheme('sunset', this)"></div>
                    <div class="theme-dot" style="background:#06b6d4;" onclick="app.setTheme('ocean', this)"></div>
                    <div class="theme-dot" style="background:#22c55e;" onclick="app.setTheme('cyber', this)"></div>
                </div>
            </div>

            <button class="btn btn-ghost" onclick="app.logout()" style="color:#ef4444;">Log Out</button>
        </div>
    </div>

    <!-- 3. PUBLIC SEND PAGE -->
    <div id="view-public" class="view-section">
        <div class="scroll-view" style="display:flex; flex-direction:column; justify-content:center;">
            <div style="text-align:center; margin-bottom:30px;">
                <div style="font-size:60px; margin-bottom:10px;">ðŸ‘»</div>
                <h2 style="font-size:28px;">Send a Secret</h2>
                <p class="text-muted">To <span id="pub-target-name" style="color:var(--text-main); font-weight:bold;">User</span></p>
            </div>

            <textarea id="pub-msg-text" class="input-field" rows="6" placeholder="Type your anonymous message here..." style="resize:none; font-size:18px;"></textarea>
            
            <button class="btn btn-primary" onclick="app.sendPublicMessage()">Send Secretly ðŸš€</button>
            <div style="text-align:center; margin-top:30px;">
                <a href="?" style="color:var(--text-sub); text-decoration:none; font-size:12px;">Get your own GhostMsg Elite</a>
            </div>
        </div>
    </div>

    <!-- NAVIGATION DOCK (Only visible when logged in) -->
    <div id="nav-dock" class="dock-nav hidden">
        <div class="dock-item active" onclick="app.nav('inbox', this)"><i class="fas fa-envelope"></i></div>
        <div class="dock-item" onclick="app.nav('profile', this)"><i class="fas fa-user"></i></div>
    </div>

</div>

<!-- STORY MODE MODAL -->
<div id="story-modal" class="story-overlay">
    <div class="story-card" id="story-capture-area">
        <div class="story-badge">GhostMsg Elite</div>
        <div style="font-size: 80px; margin-bottom: 20px; opacity:0.8;">ðŸ‘»</div>
        <h2 id="story-text" style="font-size: 24px; line-height: 1.4; margin-bottom: 20px;">
            "This is a placeholder message"
        </h2>
        <div class="text-muted" id="story-time">2 hours ago</div>
    </div>
    <div style="margin-top: 30px; display:flex; gap:15px;">
        <button class="btn btn-ghost" style="background:rgba(255,255,255,0.2); width:auto; padding: 12px 24px; border-radius:100px;" onclick="app.closeStory()">Close</button>
        <button class="btn btn-primary" style="width:auto; padding: 12px 24px; border-radius:100px;" onclick="app.simScreenshot()">ðŸ“¸ Snapshot</button>
    </div>
</div>

<div id="toast" class="toast">Action Successful</div>

<script>
    const app = {
        state: {
            user: null,
            theme: 'neon'
        },
        db: {
            users: 'elite_users',
            msgs: 'elite_msgs'
        },

        init: () => {
            // Load Theme
            const savedTheme = localStorage.getItem('elite_theme') || 'neon';
            app.applyTheme(savedTheme);

            // Check URL for Public Link
            const params = new URLSearchParams(window.location.search);
            const to = params.get('to');

            if(to) {
                app.loadPublic(to);
            } else {
                const sess = localStorage.getItem('elite_sess');
                if(sess) app.loginSuccess(sess);
                else app.show('auth');
            }
        },

        // --- NAVIGATION & UI ---
        show: (viewId) => {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById(`view-${viewId}`).classList.add('active');
            
            const dock = document.getElementById('nav-dock');
            if(viewId === 'inbox' || viewId === 'profile') dock.classList.remove('hidden');
            else dock.classList.add('hidden');
        },

        nav: (viewId, el) => {
            app.show(viewId);
            document.querySelectorAll('.dock-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
            if(viewId === 'inbox') app.renderInbox();
            if(viewId === 'profile') app.renderProfile();
        },

        toggleAuth: (mode) => {
            if(mode === 'signup') {
                document.getElementById('form-login').classList.add('hidden');
                document.getElementById('form-signup').classList.remove('hidden');
            } else {
                document.getElementById('form-signup').classList.add('hidden');
                document.getElementById('form-login').classList.remove('hidden');
            }
        },

        toast: (msg) => {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2500);
        },

        // --- THEME ENGINE ---
        setTheme: (themeName, el) => {
            localStorage.setItem('elite_theme', themeName);
            app.applyTheme(themeName);
            
            // UI Update
            document.querySelectorAll('.theme-dot').forEach(d => d.classList.remove('active'));
            if(el) el.classList.add('active');
        },

        applyTheme: (name) => {
            document.documentElement.setAttribute('data-theme', name);
        },

        // --- AUTH ---
        register: (e) => {
            e.preventDefault();
            const u = document.getElementById('r-user').value.trim().toLowerCase();
            const p = document.getElementById('r-pass').value;
            let users = JSON.parse(localStorage.getItem(app.db.users) || "{}");

            if(users[u]) return app.toast('User already taken!');
            users[u] = p;
            localStorage.setItem(app.db.users, JSON.stringify(users));
            app.toast('Account Created ðŸŒŸ');
            app.toggleAuth('login');
        },

        login: (e) => {
            e.preventDefault();
            const u = document.getElementById('l-user').value.trim().toLowerCase();
            const p = document.getElementById('l-pass').value;
            let users = JSON.parse(localStorage.getItem(app.db.users) || "{}");

            if(users[u] === p) {
                localStorage.setItem('elite_sess', u);
                app.loginSuccess(u);
            } else {
                app.toast('Invalid Credentials');
            }
        },

        loginSuccess: (u) => {
            app.state.user = u;
            app.nav('inbox', document.querySelector('.dock-item:first-child'));
        },

        logout: () => {
            localStorage.removeItem('elite_sess');
            location.href = window.location.pathname;
        },

        // --- INBOX LOGIC ---
        renderInbox: () => {
            const msgs = JSON.parse(localStorage.getItem(app.db.msgs) || "{}");
            const myMsgs = msgs[app.state.user] || [];
            const container = document.getElementById('msg-container');
            container.innerHTML = '';

            if(myMsgs.length === 0) {
                container.innerHTML = `
                    <div style="text-align:center; margin-top:50px; opacity:0.5;">
                        <i class="fas fa-wind" style="font-size:40px; margin-bottom:10px;"></i>
                        <p>No secrets yet.</p>
                    </div>
                `;
                return;
            }

            myMsgs.reverse().forEach((m, idx) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.onclick = () => app.openStory(m);
                card.innerHTML = `
                    <div style="display:flex; justify-content:space-between; margin-bottom:8px;">
                        <span style="font-size:12px; color:var(--accent); font-weight:bold;">SECRET MESSAGE</span>
                        <span class="text-muted" style="font-size:12px;">${app.timeAgo(m.date)}</span>
                    </div>
                    <div style="font-size:16px; font-weight:500;">${m.text}</div>
                    <div style="position:absolute; bottom:15px; right:15px; opacity:0.3; font-size:20px;">
                        <i class="fas fa-chevron-right"></i>
                    </div>
                `;
                container.appendChild(card);
            });
        },

        // --- STORY MODE ---
        openStory: (msg) => {
            document.getElementById('story-text').innerText = `"${msg.text}"`;
            document.getElementById('story-time').innerText = app.timeAgo(msg.date);
            document.getElementById('story-modal').classList.add('open');
        },

        closeStory: () => {
            document.getElementById('story-modal').classList.remove('open');
        },

        simScreenshot: () => {
            // In a real app, use html2canvas. Here we simulate the effect.
            app.toast('Screen Captured! (Simulated)');
            document.getElementById('story-capture-area').style.transform = "scale(0.9)";
            setTimeout(() => {
                document.getElementById('story-capture-area').style.transform = "scale(1)";
            }, 200);
        },

        // --- PROFILE ---
        renderProfile: () => {
            document.getElementById('p-user').innerText = '@' + app.state.user;
            const link = window.location.origin + window.location.pathname + "?to=" + app.state.user;
            document.getElementById('p-link').innerText = link;
        },

        copyLink: () => {
            const link = document.getElementById('p-link').innerText;
            navigator.clipboard.writeText(link);
            app.toast('Link Copied ðŸ“‹');
        },

        // --- PUBLIC MESSAGING ---
        loadPublic: (user) => {
            app.show('public');
            document.getElementById('pub-target-name').innerText = user;
            document.getElementById('view-public').setAttribute('data-target', user);
        },

        sendPublicMessage: () => {
            const txt = document.getElementById('pub-msg-text').value.trim();
            const target = document.getElementById('view-public').getAttribute('data-target');
            if(!txt) return app.toast('Message cannot be empty');

            let msgs = JSON.parse(localStorage.getItem(app.db.msgs) || "{}");
            if(!msgs[target]) msgs[target] = [];
            
            msgs[target].push({ text: txt, date: new Date().toISOString() });
            localStorage.setItem(app.db.msgs, JSON.stringify(msgs));

            app.toast('Sent Successfully ðŸš€');
            document.getElementById('pub-msg-text').value = '';
            setTimeout(() => {
                location.href = window.location.pathname; // Redirect to create account
            }, 1500);
        },

        // --- HELPER ---
        timeAgo: (dateString) => {
            const sec = Math.floor((new Date() - new Date(dateString)) / 1000);
            if (sec < 60) return 'Just now';
            const min = Math.floor(sec / 60);
            if (min < 60) return min + 'm ago';
            const hr = Math.floor(min / 60);
            if (hr < 24) return hr + 'h ago';
            return Math.floor(hr / 24) + 'd ago';
        }
    };

    // Auto Init
    window.onload = app.init;
</script>
</body>
</html>
